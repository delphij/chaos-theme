/* ==========================================================================
   CSS VARIABLES
   Global design tokens for colors, spacing, and typography.
   Uses CSS custom properties for easy theme switching and maintenance.
   ========================================================================== */

:root {
  /* Color palette - Light mode
     Primary brand colors with Japanese traditional color names */
  --bg: #FAFAFA;                    /* Page background */
  --surface: #FFFFFF;                /* Card/panel surfaces */
  --text: #222222;                   /* Body text */
  --heading: #111111;                /* Headings and titles */
  --muted: #6B6B6B;                  /* Secondary text, captions */
  --primary: #A23E48;                /* 红緋 Hi-iro (primary brand color) */
  --accent: #2E5A88;                 /* 瑠璃色 Ruri-iro (accent color) */
  --paper: #F2E8D5;                  /* 和纸感 (paper texture background) */

  /* Links - Distinct blue palette for accessibility */
  --link: #0066CC;                   /* Default link color */
  --link-hover: #004C99;             /* Link hover state */

  /* UI elements - Borders and backgrounds */
  --table-stripe: #F2F2F2;           /* Alternating table row background */
  --blockquote-fg: #444444;          /* Blockquote text color */
  --border: 1px solid rgba(0,0,0,0.06); /* Subtle border for light mode */
  --bg-translucent: rgba(250, 250, 250, 0.85); /* Semi-transparent background */

  /* Alert colors - Semantic color system for different message types */
  --alert-note-bg: #F0F4FF;          /* Note/Historical background */
  --alert-note-border: #3366CC;      /* Note border */
  --alert-tip-bg: #F0FFF4;           /* Tip background */
  --alert-tip-border: #228B22;       /* Tip border */
  --alert-important-bg: #FFF8E5;     /* Important background */
  --alert-important-border: #CC6600; /* Important border */
  --alert-warning-bg: #FFF0F0;       /* Warning/Disclaimer background */
  --alert-warning-border: #CC3333;   /* Warning border */
  --alert-caution-bg: #FAF0FF;       /* Caution background */
  --alert-caution-border: #8844AA;   /* Caution border */

  /* Layout dimensions - Spacing and container widths */
  --max-width: 1280px;               /* Maximum content width */
  --gutter: 24px;                    /* Horizontal padding */
  --radius: 10px;                    /* Border radius for cards */

  /* Typography scale - Consistent font sizing system */
  --font-size-base: 16px;            /* Base font size */
  --line-height: 1.8;                /* Line height optimized for CJK text */
  --h1-size: 28px;                   /* Article titles */
  --h2-size: 22px;                   /* Section headings */
  --h3-size: 18px;                   /* Sub-section headings */
  --small-size: 14px;                /* Small text, captions */
}

/* Dark mode variables
   Complete color palette override for dark theme.
   Maintains visual hierarchy and accessibility in low-light conditions. */
html.dark {
  --bg: #1C1C1C;                     /* Dark background */
  --surface: #222222;                /* Elevated surfaces */
  --text: #EAEAEA;                   /* Light text on dark */
  --heading: #FFFFFF;                /* High-contrast headings */
  --muted: #A8A8A8;                  /* Muted text */
  --primary: #FF6F61;                /* 珊瑚橙 (coral orange) */
  --accent: #8AB4F8;                 /* Lighter blue for dark mode */
  --paper: #2A2A2A;                  /* Subtle background variation */
  --link: #4DA6FF;                   /* Brighter link for contrast */
  --link-hover: #80C1FF;             /* Link hover in dark mode */
  --table-stripe: #242424;           /* Darker stripe for tables */
  --blockquote-fg: #CCCCCC;          /* Lighter quote text */
  --border: 1px solid rgba(255,255,255,0.04); /* Subtle dark border */
  --bg-translucent: rgba(28, 28, 28, 0.85); /* Semi-transparent background */

  /* Alert colors adapted for dark mode with higher contrast */
  --alert-note-bg: #1E2A40;
  --alert-note-border: #6699FF;
  --alert-tip-bg: #1F2D1F;
  --alert-tip-border: #66CC66;
  --alert-important-bg: #332B1E;
  --alert-important-border: #FFB84D;
  --alert-warning-bg: #3A1E1E;
  --alert-warning-border: #FF6666;
  --alert-caution-bg: #2A1E33;
  --alert-caution-border: #B266CC;
}

/* ==========================================================================
   BASE STYLES
   Foundation styles for html and body elements.
   Sets up font stack, smoothing, and Chinese typography features.
   ========================================================================== */

html,
body {
  height: 100%;                      /* Full viewport height */
}

body {
  /* Font stack: Noto Sans SC for Chinese, then system fonts as fallback */
  font-family: "Noto Sans SC", -apple-system, BlinkMacSystemFont, "Microsoft YaHei", sans-serif;
  background: var(--bg);
  color: var(--text);
  font-size: var(--font-size-base);
  line-height: var(--line-height);

  /* Font smoothing for better rendering on macOS and WebKit browsers */
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;

  /* Chinese text best practices - Modern CSS features for CJK typography
     - text-autospace: Automatic spacing between CJK and Latin characters
     - hanging-punctuation: Allow punctuation to hang outside margins
     - word-break: Smart line breaking at natural phrase boundaries */
  text-autospace: normal;
  hanging-punctuation: first allow-end last;
  word-break: auto-phrase;
}

/* ==========================================================================
   TYPOGRAPHY
   Text styling hierarchy including headings, paragraphs, links, and lists.
   Optimized for readability in both English and Chinese.
   ========================================================================== */

/* Headings - Shared styles for all heading levels */
h1,
h2,
h3 {
  color: var(--heading);
  font-weight: 700;
}

/* H1 - Page and article titles */
h1 {
  font-size: var(--h1-size);
  margin: 12px 0 10px;
  font-weight: 800;
  letter-spacing: -0.01em;           /* Tighter spacing for large text */
}

/* H2 - Major section headings */
h2 {
  font-size: var(--h2-size);
  margin: 20px 0 8px;
}

/* H3 - Sub-section headings */
h3 {
  font-size: var(--h3-size);
  margin: 16px 0 6px;
}

/* Paragraphs - Body text with orphan/widow control for better typography */
p {
  margin: 0 0 1em;
  orphans: 2;                        /* Minimum 2 lines at bottom of column */
  widows: 2;                         /* Minimum 2 lines at top of column */
}

/* Links - Dotted underline with smooth transition to solid on hover */
a {
  color: var(--link);
  text-decoration: none;
  border-bottom: 1px dotted var(--link);
  transition: border-color 0.2s ease, color 0.2s ease;
}

a:hover {
  color: var(--link-hover);
  border-bottom-style: solid;
  border-bottom-color: var(--link-hover);
}

/* Link focus state for keyboard navigation accessibility */
a:focus {
  outline: 3px solid rgba(100, 160, 255, 0.18);
  outline-offset: 2px;
}

/* Link variants - Plain links without underline for navigation */
.link-plain,
.brand,
nav.main-links a {
  border-bottom: none;
  text-decoration: none;
}

.link-plain:hover,
.brand:hover {
  border-bottom: none;
}

/* Lists - Minimal left padding with tabular numerals for alignment */
ul,
ol {
  margin: 1em 0;                      /* Consistent spacing before and after lists */
  font-variant-numeric: tabular-nums; /* Consistent number width */
}

ul {
  padding-left: 15px;                 /* Minimal padding for bullets */
}

/* ==========================================================================
   LAYOUT - CONTAINER
   Main content container with responsive max-width and horizontal padding.
   ========================================================================== */

.container {
  max-width: var(--max-width);
  margin: 28px auto;
  padding: 0 var(--gutter);
}

/* ==========================================================================
   LAYOUT - NAVIGATION
   Sticky header with blur effect and flexbox-based navigation menu.
   ========================================================================== */

/* Site navigation - Sticky header with backdrop blur */
.site-nav {
  width: 100%;
  background: linear-gradient(180deg, transparent, rgba(0, 0, 0, 0.02));
  -webkit-backdrop-filter: blur(6px); /* Safari < 18 compatibility */
  backdrop-filter: blur(6px);
  position: sticky;
  top: 0;
  z-index: 40;
  border-bottom: var(--border);
}

/* Navigation inner container - Flexbox layout for brand and menu */
.nav-inner {
  max-width: calc(var(--max-width) + 2 * var(--gutter));
  margin: 0 auto;
  padding: 12px var(--gutter);
  display: flex;
  align-items: center;
  gap: 12px;
}

/* Brand/logo - Site name with optional subtitle */
.brand {
  font-weight: 700;
  letter-spacing: 0.02em;
  color: var(--heading);
  display: flex;
  align-items: baseline;
  gap: 10px;
}

.brand .subtitle {
  font-size: var(--small-size);
  color: var(--muted);
  margin-left: 6px;
  font-weight: 500;
}

.main-title {
  font-size: var(--h3-size);
}

/* Navigation links - Right-aligned menu items */
nav.main-links {
  margin-left: auto;                 /* Push to right side */
  display: flex;
  gap: 14px;
  align-items: center;
}

nav.main-links a {
  color: var(--muted);
  font-weight: 600;
}

nav.main-links a:hover {
  color: var(--primary);
}

/* Theme toggle button - Dark/light mode switcher */
.theme-toggle {
  border: 0;
  background: transparent;
  cursor: pointer;
  font-weight: 600;
  padding: 6px 8px;
  border-radius: 6px;
}

.theme-toggle:hover {
  background: var(--paper);
}

/* Menu toggle button - Hamburger menu for mobile */
.menu-toggle {
  display: none;                     /* Hidden by default on desktop */
  border: 0;
  cursor: pointer;
  font-weight: 600;
  padding: 6px 8px;
  border-radius: 6px;
  font-size: 20px;
  line-height: 1;
  color: var(--heading);             /* Use heading color for visibility in both modes */
}

.menu-toggle:hover {
  background: var(--paper);
  color: var(--primary);
}

/* ==========================================================================
   LAYOUT - FOOTER
   Centered footer with muted text for copyright and supplementary info.
   ========================================================================== */

footer.site-foot {
  max-width: var(--max-width);
  margin: 40px auto 80px;
  padding: 24px var(--gutter);
  color: var(--muted);
  font-size: 13px;
  text-align: center;
}

/* ==========================================================================
   CONTENT - ARTICLES
   Article-specific styling with Chinese typography enhancements.
   Includes justified text and CJK spacing optimizations.
   ========================================================================== */

article.post {
  background: transparent;
  color: var(--text);

  /* Chinese typography enhancements for professional text layout
     - text-align: justify - Creates aligned character grids (standard in Chinese)
     - text-spacing-trim: Optimizes CJK punctuation spacing (Chrome 133+, Safari 18.2+)
     - line-break: strict - Enforces strict CJK line-breaking rules */
  text-align: justify;
  text-spacing-trim: space-all;
  line-break: strict;
}

/* Article metadata - Post date, reading time, etc. */
article .meta {
  color: var(--muted);
  font-size: 13px;
  margin-bottom: 8px;
}

/* ==========================================================================
   COMPONENTS - TABLES
   Responsive table styling with striped rows and inverted header colors.
   ========================================================================== */

table {
  width: 100%;
  margin: 1em 0;
}

/* Table cells - Consistent padding and borders */
table th,
table td {
  border-bottom: 1px solid var(--border);
  padding: 0.75rem;
  text-align: left;
  vertical-align: top;
}

/* Table header - Inverted colors for visual hierarchy */
table thead th {
  border-bottom: 2px solid var(--border);
  vertical-align: bottom;
  background-color: var(--text);
  color: var(--bg);
}

/* Multiple table bodies - Visual separator */
table tbody + tbody {
  border-top: 2px solid var(--border);
}

/* Striped rows - Zebra striping for easier row scanning */
table tbody tr:nth-of-type(even) {
  background-color: var(--table-stripe);
}

/* ==========================================================================
   COMPONENTS - BLOCKQUOTES
   Styled quote blocks with left border accent and background tint.
   Lists within quotes have extra padding for proper alignment.
   ========================================================================== */

blockquote {
  border-left: 4px solid var(--accent);
  margin: 16px 0;
  padding: 12px 16px;
  background: var(--paper);
  border-radius: 6px;
  color: var(--blockquote-fg);
  font-style: normal;
  font-size: 0.95em;
}

/* Lists inside blockquotes - Extra padding to align with quote content */
blockquote ol,
blockquote ul {
  padding-left: 30px;                /* Double normal padding for visual alignment */
}

/* ==========================================================================
   COMPONENTS - ALERTS
   Semantic alert boxes for notes, tips, warnings, and other callouts.
   Color-coded for different message types with consistent styling.
   ========================================================================== */

/* Base alert styles - Left border with rounded corners */
.alert {
  border-left: 4px solid;
  padding: 1em;
  margin: 1.5em 0;
  border-radius: 0.5em;
  font-size: var(--font-size-base);
  line-height: var(--line-height);
}

/* Alert variants - Different colors for semantic meaning */
.alert-note,
.alert-historical {
  background: var(--alert-note-bg);
  border-color: var(--alert-note-border);
}

.alert-tip {
  background: var(--alert-tip-bg);
  border-color: var(--alert-tip-border);
}

.alert-important {
  background: var(--alert-important-bg);
  border-color: var(--alert-important-border);
}

.alert-warning,
.alert-disclaimer {
  background: var(--alert-warning-bg);
  border-color: var(--alert-warning-border);
}

.alert-caution {
  background: var(--alert-caution-bg);
  border-color: var(--alert-caution-border);
}

/* ==========================================================================
   COMPONENTS - CODE HIGHLIGHTING
   Syntax highlighting styles for code blocks using Chroma.
   Includes line numbers, horizontal scroll, and selection behavior.
   ========================================================================== */

/* Code block wrapper - Scroll container for wide code */
.highlight pre {
  margin: 0;
  padding: 12px;
  overflow-x: auto;
  max-width: 100%;
}

/* Chroma structural styles - Layout for syntax highlighting components */

/* Line number links - Remove default link styling */
.chroma .lnlinks {
  outline: none;
  text-decoration: none;
  color: inherit;
}

/* Line number table cells - Reset spacing */
.chroma .lntd {
  vertical-align: top;
  padding: 0;
  margin: 0;
  border: 0;
}

/* Line number table - Horizontal scroll container */
.chroma .lntable {
  border-spacing: 0;
  padding: 0;
  margin: 0;
  border: 0;
  overflow-x: auto;
  display: block;
  max-width: 100%;
}

/* Line numbers - Unselectable with consistent spacing */
.chroma .lnt,
.chroma .ln {
  white-space: pre;
  -webkit-user-select: none;
  user-select: none;
  margin-right: 0.4em;
  padding: 0 0.4em 0 0.4em;
}

/* Code lines - Flex layout for alignment */
.chroma .line {
  display: flex;
}

/* Line number column spacing */
.highlight .lntable .lntd:first-child {
  padding-right: 8px;
}

/* ==========================================================================
   COMPONENTS - PAGINATION
   Previous/next navigation for paginated content.
   Flexbox layout with space-between alignment.
   ========================================================================== */

.pager {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  margin: 28px 0;
  padding: 0;
}

/* Pagination items - Remove list styling */
.pager li {
  list-style: none;
  display: inline-block;
  margin: 0;
  padding: 0;
}

/* Pagination links - Button-style with border */
.pager a {
  display: inline-block;
  padding: 8px 12px;
  border-radius: 8px;
  font-weight: 700;
  border: var(--border);
  color: var(--heading);
}

.pager a:hover {
  background: var(--paper);
  color: var(--primary);
}

/* Pagination alignment - Previous left, next right */
.pager .page-prev {
  text-align: left;
}

.pager .page-next {
  margin-left: auto;
  text-align: right;
}

/* ==========================================================================
   SPECIALIZED - CHINESE TYPOGRAPHY
   Advanced typography features for Chinese text including ruby annotations
   (phonetic guides) and emphasis dots for strong emphasis.
   ========================================================================== */

/* Ruby annotations - Phonetic notation marks
   Used for showing pronunciation above Chinese characters */
ruby {
  ruby-position: over;               /* Position annotations above base text */
  font-variant-east-asian: ruby;
}

/* Ruby base text - The main character */
rb {
  font-size: 1em;
}

/* Ruby text - The small pronunciation guide */
rt {
  font-size: 0.65em;
  line-height: 1;
  color: var(--muted);
  font-weight: normal;
  letter-spacing: 0.05em;
  padding: 0 0.1em;
}

/* Chinese emphasis dots - Traditional emphasis marks
   Uses text-emphasis instead of bold for CJK text */
strong {
  font-weight: bold;
  text-emphasis: filled dot;         /* Adds dots below characters */
  text-emphasis-position: under;     /* Position below for horizontal text */
}

/* ==========================================================================
   ACCESSIBILITY
   Focus states and keyboard navigation support.
   ========================================================================== */

button:focus {
  outline: 3px solid rgba(100, 160, 255, 0.18);
  outline-offset: 2px;
}

/* ==========================================================================
   RESPONSIVE / MEDIA QUERIES
   Breakpoints for tablet and mobile devices.
   Adjusts layout, typography, and navigation for smaller screens.
   ========================================================================== */

/* Tablet breakpoint - Narrower content width */
@media (max-width: 900px) {
  :root {
    --max-width: 680px;
  }

  .nav-inner {
    padding: 10px 16px;
  }

  article h1 {
    font-size: 24px;
  }
}

/* Mobile breakpoint - Full width, hamburger menu */
@media (max-width: 600px) {
  :root {
    --max-width: 100%;
  }

  .nav-inner {
    gap: 8px;
    position: relative;              /* For absolute positioning of menu */
  }

  /* Brand comes first, takes remaining space */
  .brand {
    font-size: 16px;
    flex: 1;                         /* Take remaining space */
  }

  /* Show hamburger menu button on mobile - positioned before theme toggle */
  .menu-toggle {
    display: block;
  }

  /* Hide main navigation by default on mobile */
  nav.main-links {
    display: none;
    flex-direction: column;
    position: absolute;              /* Overlay instead of pushing content */
    top: 100%;                       /* Position below nav-inner */
    left: 0;
    right: 0;
    gap: 8px;
    padding: 12px var(--gutter);
    border-top: var(--border);
    background: var(--bg-translucent);  /* Semi-transparent for blur visibility */
    -webkit-backdrop-filter: blur(12px);  /* Safari/Chrome */
    backdrop-filter: blur(12px);     /* Modern browsers */
    z-index: 50;                     /* Above content, below modals */
  }

  /* Fallback for browsers without backdrop-filter support */
  @supports not (backdrop-filter: blur(12px)) {
    nav.main-links {
      background: var(--bg);         /* Solid background fallback */
    }
  }

  /* Show navigation when menu is open */
  nav.main-links.menu-open {
    display: flex;
  }

  /* Stack navigation links vertically on mobile */
  nav.main-links a {
    padding: 8px 12px;
  }

  nav.main-links a:hover {
    color: var(--primary);
  }

  /* Hide subtitle on mobile to save space */
  .brand .subtitle {
    display: none;
  }
}
